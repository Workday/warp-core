<!DOCTYPE html>
<html>
  <head>
    <title>warp-core</title>
    
      <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no">
<meta name="generator" content="Hugo 0.38" />
<title>Custom Arbiters :: warp-core</title>
<link rel="shortcut icon" href="https://workday.github.io/warp-core/images/favicon.png" type="image/x-icon" />
<link href="https://workday.github.io/warp-core/css/font-awesome.min.css" rel="stylesheet">
<link href="https://workday.github.io/warp-core/css/nucleus.css" rel="stylesheet">
<link href="https://workday.github.io/warp-core/theme-flex/style.css" rel="stylesheet">

<link rel="stylesheet" href="https://workday.github.io/warp-core/css/bootstrap.min.css">
<script src="https://workday.github.io/warp-core/js/jquery-2.x.min.js"></script>
<script type="text/javascript">
      var baseurl = "https:\/\/workday.github.io\/warp-core\/";
</script>
<meta name="description" content="">


    
  </head>
  <body data-url="/contents/custom_arbiters/">
    
      <header>
  <div class="logo">
    
	
  
    <a class="baselink" href="https://workday.github.io/warp-core/">warp-core</a>
  

  </div>
  <div class="burger"><a href="javascript:void(0);" style="font-size:15px;">&#9776;</a></div>
    <nav class="shortcuts">
            <li class="" role="">
                <a href="https://github.com/Workday/warp-core"  rel="noopener">
                  <i class='fa fa-github'></i> <label>Github Repo</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/Workday/warp-core/releases"  rel="noopener">
                  <i class='fa fa-cloud-download'></i> <label>Releases</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://workday.github.io/warp-core/scaladoc/warp-core/index.html"  rel="noopener">
                  <i class='fa fa-bookmark'></i> <label>ScalaDoc</label>
                </a>
            </li>
            <li class="" role="">
                <a href="https://github.com/Workday/warp-core/blob/master/CONTRIBUTORS.md"  rel="noopener">
                  <i class='fa fa-bullhorn'></i> <label>Contributors</label>
                </a>
            </li>
    </nav>
</header>
<article>
  <aside>
    <ul class="menu">
          <li data-nav-id="/" class="dd-item">
          <a href="https://workday.github.io/warp-core/">
            <i class="fa fa-fw fa-home"></i>
          </a>
          </li>
    <li data-nav-id="/contents/" class="dd-item parent alwaysopen haschildren
        ">
      <div>
      <a href="https://workday.github.io/warp-core/contents/">Contents</a>
            <i class="fa fa-angle-down fa-lg category-icon"></i><i class="fa fa-circle-thin read-icon"></i>
      </div>
        <ul>
      <li data-nav-id="/contents/intro/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/intro/">
            Introduction
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/getting_started_java/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/getting_started_java/">
            Getting Started (Java)
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/getting_started_scala/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/getting_started_scala/">
            Getting Started (Scala DSL)
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/custom_collectors/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/custom_collectors/">
            Collecting Custom Measurements
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/custom_arbiters/" class="dd-item active">
        <div>
          <a href="https://workday.github.io/warp-core/contents/custom_arbiters/">
            Custom Arbiters
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/measurement_collection_controller/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/measurement_collection_controller/">
            Measurement Collection Controller
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/tags/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/tags/">
            Tags
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/runtime_configuration/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/runtime_configuration/">
            Runtime Property Configuration
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/persistence/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/persistence/">
            Persistence
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/dependency_injection/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/dependency_injection/">
            Dependency Injection
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/anomaly_detection/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/anomaly_detection/">
            Case Study: RPCA Anomaly Detection
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/hypothesis_testing/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/hypothesis_testing/">
            Case Study: Hypothesis Testing
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/heap_histogram/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/heap_histogram/">
            Case Study: Monitoring Heap Histogram
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/extension_advanced/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/extension_advanced/">
            Extending the Schema (advanced)
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
      <li data-nav-id="/contents/_footer/" class="dd-item">
        <div>
          <a href="https://workday.github.io/warp-core/contents/_footer/">
            
          </a><i class="fa fa-circle-thin read-icon"></i>
        </div>
    </li>
        </ul>
    </li>




    </ul>
    <section>
    </section>
  </aside>
  <section class="page">
    
    <div class="nav-select">
      <center>Navigation : 
        <select onchange="javascript:location.href = this.value;">
          
    <option value="/contents/" >
   Contents</option> 
      <option value="/contents/intro/" >- Introduction</option>
      <option value="/contents/getting_started_java/" >- Getting Started (Java)</option>
      <option value="/contents/getting_started_scala/" >- Getting Started (Scala DSL)</option>
      <option value="/contents/custom_collectors/" >- Collecting Custom Measurements</option>
      <option value="/contents/custom_arbiters/"  selected>- Custom Arbiters</option>
      <option value="/contents/measurement_collection_controller/" >- Measurement Collection Controller</option>
      <option value="/contents/tags/" >- Tags</option>
      <option value="/contents/runtime_configuration/" >- Runtime Property Configuration</option>
      <option value="/contents/persistence/" >- Persistence</option>
      <option value="/contents/dependency_injection/" >- Dependency Injection</option>
      <option value="/contents/anomaly_detection/" >- Case Study: RPCA Anomaly Detection</option>
      <option value="/contents/hypothesis_testing/" >- Case Study: Hypothesis Testing</option>
      <option value="/contents/heap_histogram/" >- Case Study: Monitoring Heap Histogram</option>
      <option value="/contents/extension_advanced/" >- Extending the Schema (advanced)</option>
      <option value="/contents/_footer/" >- </option>
  



        </select>
      </center>
    </div>
      <div>
        <div class="searchbox">
          <input data-search-input id="search-by" type="text" placeholder="Search...">
        </div>
        <script type="text/javascript" src="https://workday.github.io/warp-core/js/lunr.min.js"></script>
        <script type="text/javascript" src="https://workday.github.io/warp-core/js/auto-complete.js"></script>
        <link href="https://workday.github.io/warp-core/css/auto-complete.css" rel="stylesheet">
        <script type="text/javascript">
          
              var baseurl = "https:\/\/workday.github.io\/warp-core\/";
          
        </script>
        <script type="text/javascript" src="https://workday.github.io/warp-core/js/search.js"></script>
      </div>
    

    <h1>Custom Arbiters</h1>
    
    
    
    

<p>An <code>Arbiter</code> defines a <code>vote</code> method that allows us to implement custom failure criteria for a given test execution.</p>

<p>For example, the following <code>Arbiter</code> implementation fails a test if it took longer than 5 seconds:
<div class="highlight"><pre style="color:#272822;background-color:#fafafa;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-scala" data-lang="scala"><span style="color:#00a8c8">class</span> <span style="color:#75af00">ResponseTimeArbiter</span> <span style="color:#00a8c8">extends</span> <span style="color:#75af00">ArbiterLike</span> <span style="color:#00a8c8">with</span> <span style="color:#75af00">CorePersistenceAware</span> <span style="color:#f92672">{</span>

  <span style="color:#75715e">/**
</span><span style="color:#75715e">    * Checks that the measured test took less than 5 seconds.
</span><span style="color:#75715e">    *
</span><span style="color:#75715e">    * @param ballot box used to register vote result.
</span><span style="color:#75715e">    * @param testExecution [[TestExecutionRowLikeType]] we are voting on.
</span><span style="color:#75715e">    * @return a wrapped error with a useful message, or None if the measured test passed its requirement.
</span><span style="color:#75715e">    */</span>
  <span style="color:#00a8c8">override</span> <span style="color:#00a8c8">def</span> <span style="color:#111">vote</span><span style="color:#f92672">[</span><span style="color:#00a8c8">T:</span> <span style="color:#00a8c8">TestExecutionRowLikeType</span><span style="color:#f92672">](</span><span style="color:#111">ballot</span><span style="color:#00a8c8">:</span> <span style="color:#00a8c8">Ballot</span><span style="color:#f92672">,</span> <span style="color:#111">testExecution</span><span style="color:#00a8c8">:</span> <span style="color:#00a8c8">T</span><span style="color:#f92672">)</span><span style="color:#00a8c8">:</span> <span style="color:#00a8c8">Option</span><span style="color:#f92672">[</span><span style="color:#00a8c8">Throwable</span><span style="color:#f92672">]</span> <span style="color:#00a8c8">=</span> <span style="color:#f92672">{</span>
    <span style="color:#00a8c8">val</span> <span style="color:#111">testId</span><span style="color:#00a8c8">:</span> <span style="color:#00a8c8">String</span> <span style="color:#f92672">=</span> <span style="color:#00a8c8">this</span><span style="color:#f92672">.</span><span style="color:#111">persistenceUtils</span><span style="color:#f92672">.</span><span style="color:#111">getMethodSignature</span><span style="color:#f92672">(</span><span style="color:#111">testExecution</span><span style="color:#f92672">)</span>

    <span style="color:#00a8c8">if</span> <span style="color:#f92672">(</span><span style="color:#111">testExecution</span><span style="color:#f92672">.</span><span style="color:#111">responseTime</span> <span style="color:#f92672">&gt;</span> <span style="color:#ae81ff">5</span><span style="color:#f92672">)</span> <span style="color:#f92672">{</span>
      <span style="color:#75af00">Option</span><span style="color:#f92672">(</span><span style="color:#00a8c8">new</span> <span style="color:#75af00">RequirementViolationException</span><span style="color:#f92672">(</span><span style="color:#d88200">s&#34;</span><span style="color:#d88200">$testId</span><span style="color:#d88200"> took longer than 5 seconds&#34;</span><span style="color:#f92672">))</span>
    <span style="color:#f92672">}</span>
    <span style="color:#00a8c8">else</span> <span style="color:#f92672">{</span>
      <span style="color:#75af00">None</span>
    <span style="color:#f92672">}</span>
  <span style="color:#f92672">}</span>
<span style="color:#f92672">}</span></code></pre></div></p>

<p>Some arbiters may want access to historical data in order to make an informed decision about the most recent test invocation.
To easily access historical data, mix in the trait <code>CanReadHistory</code>. For example, using this mechanism, we can
implement an arbiter that votes based on the z-score of the most recently test execution. Using such an arbiter,
for example, we can fail any test whose recorded measurement value is greater standard deviations away from the
historical mean.</p>

<h2 id="anomaly-detection">Anomaly Detection</h2>

<p>WARP includes an arbiter that uses machine learning to cast votes.
The <code>RobustPcaArbiter</code> votes based on the results of an anomaly detection algorithm,
Robust Principal Component Analysis (RPCA).
Internally, we use this arbiter to fail any tests that have
suspicious or anomalous measurements.
See the dedicated RPCA page <a href="https://workday.github.io/warp-core/contents/anomaly_detection/">here</a> for a more detailed description of how
this algorithm works, including our novel algorithmic extension designed to improve strictness and avoid
false negatives over time.</p>


    
    
        <div class="chevrons">
    <div id="navigation">
<a class="nav nav-prev" href="https://workday.github.io/warp-core/contents/custom_collectors/" title="Collecting Custom Measurements"> <i class="fa fa-chevron-left"></i><label>Collecting Custom Measurements</label></a>
    <a class="nav nav-next" href="https://workday.github.io/warp-core/contents/measurement_collection_controller/" title="Measurement Collection Controller" style="margin-right: 0px;"><label>Measurement Collection Controller</label><i class="fa fa-chevron-right"></i></a></div>
  </div>

  </section>
</article>

<footer>

<div class="footline">
    

    

  
    <div class="date">
        <i class='fa fa-calendar'></i> Last update on 03/04/2018
    </div>
    

    <div class="github-link">
      <a href="https://github.com/vjeantet/hugo-theme-docdock/edit/master/exampleSite/content/contents/custom_arbiters.md" target="blank"><i class="fa fa-code-fork"></i>
        Improve this page</a>
    </div>
  </div>


	<div>


  
    
  



	</div>
</footer>

<script src="https://workday.github.io/warp-core/js/clipboard.min.js"></script>

<link href="https://workday.github.io/warp-core/css/featherlight.min.css" rel="stylesheet">
<script src="https://workday.github.io/warp-core/js/featherlight.min.js"></script>



<script src="https://workday.github.io/warp-core/theme-flex/script.js"></script>

    

    
    

    
  </body>
</html>